<html>

<head>
    <script src="https://gve.wl.group.video/v1/lib.js"></script>
</head>

<body>
    <iframe id="iframe" allow="microphone;camera" src="index.html?name=mehrdad&room=test1"
        style="width: 100%;height: 100%;"></iframe>
    <div>
        <button id="audio-btn" onclick="audioClick(this)">muteMyAudio</button>
        <button id="video-btn" onclick="videoClick(this)">hideMyVideo</button>
        <button id="sc-btn" onclick="scClick(this)">activateMyScreenshare</button>
        <button
            onclick="gv.getAudioVideoStatus().then(res => {alert(JSON.stringify(res));});">getAudioVideoStatus</button>
        <button
            onclick="gv.getScreenShareStatus().then(res => {alert(JSON.stringify(res));});">getScreenShareStatus</button>
    </div>
    <script>
        const gv = new window.GroupVideo(document.getElementById("iframe"));
        window.addEventListener("message", async (event) => {
            console.log("Received message: ", event);
            try {
                const msg = JSON.parse(event.data);
                if (msg.type === 'CALL_STATUS_UPDATE') {
                    if (msg.data.isMyAudioMuted) {
                        document.getElementById("audio-btn").innerText = "unmuteMyAudio";
                    } else {
                        document.getElementById("audio-btn").innerText = "muteMyAudio";
                    }
                    if (msg.data.isMyVideoHidden) {
                        document.getElementById("video-btn").innerText = "unhideMyVideo";
                    } else {
                        document.getElementById("video-btn").innerText = "hideMyVideo";
                    }
                    if (msg.data.screenShareState === 'MY_SCREENSHARE_ACTIVATED') {
                        document.getElementById("sc-btn").innerText = "deactivateMyScreenshare";
                    } else {
                        document.getElementById("sc-btn").innerText = "activateMyScreenshare";
                    }
                }
            } catch(e) {
                console.log(e);
            }
        });
        function audioClick(dobj) {
            if (dobj.innerText === 'muteMyAudio') {
                gv.muteMyAudio();
            } else {
                gv.unmuteMyAudio();
            }
        }
        function videoClick(dobj) {
            if (dobj.innerText === 'hideMyVideo') {
                gv.hideMyVideo();
            } else {
                gv.unhideMyVideo();
            }
        }
        function scClick(dobj) {
            if (dobj.innerText === 'activateMyScreenshare') {
                gv.activateMyScreenshare();
            } else {
                gv.deactivateMyScreenshare();
            }
        }
    </script>
</body>

</html>